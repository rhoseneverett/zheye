import{d as p,c as u,a as l,F as P,r as w,b as e,e as h,w as y,f as $,t as d,u as m,R as L,h as _,G as B,o as r,k as S,z as I,g as N,s as V}from"./index-Fwnne_Bv.js";import{g as F,a as M}from"./helper-TXTB4Bdo.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as U,a as z}from"./useLoadMore-xyN6FS_U.js";import{u as A}from"./post-Baks0WKW.js";const D={class:"post-list"},j={class:"card-body"},E={class:"row my-3 align-items-center"},G={key:0,class:"col-4"},T=["src","alt"],q={class:"text-muted"},H=p({__name:"PostList",props:{list:{}},setup(v){const n=v,s=u(()=>n.list.map(a=>(a.image&&F(a.image,200,110,["m_fill"]),a)));return(a,c)=>(r(),l("div",D,[(r(!0),l(P,null,w(s.value,t=>(r(),l("article",{key:t._id,class:"card mb-3 shadow-sm"},[e("div",j,[e("h4",null,[h(m(L),{to:`/posts/${t._id}/`},{default:y(()=>[$(d(t.title),1)]),_:2},1032,["to"])]),e("div",E,[t.image?(r(),l("div",G,[e("img",{src:t.image.fitUrl,alt:t.title,class:"rounded-lg w-100"},null,8,T)])):_("",!0),e("p",{class:B([{"col-8":t.image},"text-muted"])},d(t.excerpt),3)]),e("span",q,d(t.createdAt),1)])]))),128))]))}}),J=R(H,[["__scopeId","data-v-a2c8497b"]]),K={class:"column-detail-page w-75 mx-auto"},O={key:0,class:"column-info row mb-4 border-bottom pb-4 align-items-center"},Q={class:"col-3 text-center"},W=["src","alt"],X={class:"col-9"},Y={class:"text-muted"},at=p({__name:"ColumnDetail",setup(v){const n=U(),s=A(),a=I(),c=S(a.params.id),t=u(()=>{const o=n.getColumnById(c.value);return o&&M(o,100,100),o}),g=u(()=>s.getPostsByCid(c.value));N(()=>{n.fetchColumn(c.value),s.fetchPosts({cid:c.value})}),V(()=>a.params,o=>{const i=o&&o.id;n.fetchColumn(i),s.fetchPosts({cid:i}),c.value=o.id});const b=u(()=>s.total),x=u(()=>s.currentPage),{loadMorePage:f,isLastPage:C}=z(s,"fetchPosts",{currentPage:x,total:b,cid:c.value});return(o,i)=>(r(),l("div",K,[t.value?(r(),l("div",O,[e("div",Q,[e("img",{src:t.value.avatar&&t.value.avatar.fitUrl,alt:t.value.title,class:"rounded-circle border w-100"},null,8,W)]),e("div",X,[e("h4",null,d(t.value.title),1),e("p",Y,d(t.value.description),1)])])):_("",!0),h(J,{list:g.value},null,8,["list"]),m(C)?_("",!0):(r(),l("button",{key:1,class:"btn btn-outline-primary mt-2 mb-5 mx-auto btn-block w-25 d-block",onClick:i[0]||(i[0]=(...k)=>m(f)&&m(f)(...k))}," 加载更多 "))]))}});export{at as default};
